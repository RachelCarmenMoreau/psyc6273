function rgb = lum2rgb( lum )% LUM2RGB  Convert luminance (cd/m^2) to framebuffer RGB values%% rgb = lum2rgb( lum )% get calibration dataglobal CAL% check luminance rangeminlum=CAL.gamma(4);maxlum=CAL.gamma(1)+CAL.gamma(4);if any( lum<minlum | lum>maxlum )    warning('luminances out of range');    lum(lum<minlum)=minlum;    lum(lum>maxlum)=maxlum;end% convertinvgamma = @( lum ) (255-CAL.gamma(2))*power( (lum-CAL.gamma(4))/CAL.gamma(1), 1/CAL.gamma(3) ) + CAL.gamma(2);rgb = invgamma( lum );rgb = round( rgb );rgb = repmat(rgb,[ 1 1 3 ]);return